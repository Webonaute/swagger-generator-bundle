{% macro create_path(path, operationParameters, type_mapping) %}
{% set replacement = "" %}
{% for parameter in operationParameters %}
{% if parameter is instanceof("Draw\\Swagger\\Schema\\PathParameter") %}
{% set search = "{" ~ parameter.name ~ "}" %}
{% set replacement =  "${" ~ parameter.name ~ "}" %}
{% set path = path|replace({ (search): replacement}) %}
{% endif %}
{% endfor %}
const routePath = `{{ path|ltrim('/') }}`;
{% endmacro %}

{% macro list_operation_params(operationParameters, type_mapping) %}{% set params = "" %}{% for parameter in operationParameters %}{% if parameter is instanceof("Draw\\Swagger\\Schema\\PathParameter") %}{% set params = params ~ "\n           " ~ parameter.name ~ ": " ~ parameter|convert_type(type_mapping) ~ ","  %}{% endif %}{% endfor %}{{ params }}{% endmacro %}
{% macro list_operation_params_doc(operationParameters, type_mapping) %}{% set params = "" %}{% for parameter in operationParameters %}{% if parameter is instanceof("Draw\\Swagger\\Schema\\PathParameter") %}{% set params = params ~ "\n     * @param " ~ parameter.name ~ ""  %}{% endif %}{% endfor %}{{ params }}{% endmacro %}
{% macro operation_params_require(operationParameters, type_mapping, operation) %}
{% set params = "" %}
{% for parameter in operationParameters %}
{% if parameter is instanceof("Draw\\Swagger\\Schema\\PathParameter") %}
        if ({{ parameter.name }} === null || {{ parameter.name }} === undefined) {
            throw new Error('Required parameter {{ parameter.name }} was null or undefined when calling {{ operation.operationId|camelize|camelizeDash }}.');
        }
{% endif %}
{% endfor %}
{% endmacro %}
{% macro handle_responses(operation) %}
{% import _self as macro %}{% if operation.responses|length > 0 %}
{% for responseCode, response in operation.responses %}
                {% if loop.first %}if (response.status === {{ responseCode }}) {{ "{\n" }}{% else %}{{ "}" }} else if (response.status === {{ responseCode }}) {{ "{" }}{% endif %}{{ "" }}
                    {% if responseCode == "204" %}return { success: true };{% elseif responseCode < "300" %}{{ macro.handle_return_hydratation(operation) }}{% else %}return response.json();{% endif %}{{ "" }}
{% endfor %}
                }
{% else %}
                {{ macro.handle_return_hydratation(operation) }}
{% endif %}
{% endmacro %}
{% macro handle_return_hydratation(operation) %}
{% set type = operation|schema_type_of_operation(dsg.registry.ts.type_mapping) %}
{% set model = getModelByOperation(operation, 'models.', '') %}
{% if model == "" %}return response.json();{% else %}{% if type == "array" %}return response.json().map({{ "\n                        " }}(item) => new {{ model }}().hydrate(item){{ "\n                    " }});{% else %}return new {{ model }}().hydrate(response.json());{% endif %}{% endif %}{% endmacro %}